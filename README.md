## Обзор

Этот репозиторий предоставляет повторяемое рабочее окружение для разработки на C++ внутри Docker‑контейнера с заранее установленными инструментами: компилятором и сервером clang/clangd, системой сборки CMake и сопутствующими утилитами.  
Основная идея — «клонировать репозиторий, открыть его в VS Code и сразу получить готовый dev‑container», не настраивая C++ toolchain на хостовой машине.

---

## Состав проекта

### Структура директорий

Фактическая структура может меняться, но логика следующая:

- Корень репозитория:
  - `Dockerfile` или `.devcontainer/Dockerfile` — рецепт сборки образа с C++ toolchain.
  - `.devcontainer/` — конфигурация development‑контейнера для VS Code:
    - `devcontainer.json` — настройки VS Code внутри контейнера.
  - `.vscode/` — локальные настройки и рекомендуемые расширения рабочей области:
    - `projects/CMakeLists.txt` — корневой файл CMake‑проекта.
    - Исходники C++ (обычно в подкаталогах `src/`, `include/` и т.п., если они присутствуют).
  - Конфигурационные файлы:
    - `.clang-format` — правила форматирования кода.
    - `.clang-tidy` и `.clangd` - конфиги статического анализа.
    - `.cspell.json` - конфиг со словарем для spell checker

---

## Используемые технологии

### Инструменты внутри контейнера

Внутри Docker‑окружения доступны:

- `clang` / `clang++` — компилятор C/C++.
- `clangd` — language server для автодополнения, навигации и диагностики.
- `cmake` — система сборки C++ проекта.
- `make` и/или `ninja` — генераторы/исполнители сборки, используемые CMake.
- `clang-tidy` — статический анализатор кода.

### Интеграция с VS Code

Репозиторий ориентирован на работу с Visual Studio Code и расширением Dev Containers (Remote – Containers в старых версиях):

- При открытии папки репозитория VS Code обнаруживает `.devcontainer` и предлагает «Reopen in Container».
- Dev‑container поднимается на основе описанного Dockerfile, после чего:
  - Устанавливаются расширения VS Code, перечисленные в `devcontainer.json` (или могут быть описаны в `.vscode/extensions.json`).
  - Применяются настройки из `.vscode/settings.json`.
---

## Как начать работу

### Предварительные требования

- Установлен Docker (Docker Engine / Docker Desktop) на хостовой машине.
- Установлен Visual Studio Code.
- В VS code становлено расширение Dev Containers (или Remote – Containers).

### Клонирование и запуск контейнера

1. Клонировать репозиторий:

```
git clone https://github.com/romanvac/cpp-workspace.git
cd cpp-workspace
```

2. Открыть директорию в VS Code:

```
code .
```


3. При первом открытии VS Code предложит «Reopen in Container» (или аналогичный диалог):

- Выбрать открытие в контейнере.
- Дождаться сборки dev‑образа и запуска контейнера (обычно это занимает несколько минут при первом запуске).

После подключения к контейнеру все терминалы внутри VS Code работают уже в этом окружении с преднастроенным C++ toolchain.

---

## Сборка и запуск C++ кода

### Поддержка clangd

Для полноценной работы clangd необходим файл `compile_commands.json`:

- При включённом экспорте команд в CMake файл создаётся в директории сборки (`build/`).
- clangd использует этот файл для понимания include‑путей, макросов и флагов компилятора.

В зависимости от конфигурации его можно:

- Либо указывать clangd через настройки.
- Либо размещать (или линкующим) в корне проекта.

---

## Работа с контейнером

### Пересборка и обновление

При изменении Dockerfile или конфигурации dev‑контейнера:

- В VS Code можно вызвать команду `Dev Containers: Rebuild Container` (через Command Palette).
- Будет пересобран образ и перезапущен контейнер с учётом изменений.

### Особенности и ограничения

- Все зависимости для сборки и разработки C++ находятся внутри контейнера; на хостовой системе достаточно только Docker и VS Code.
- Исходный код хранится на хосте и монтируется в контейнер; права доступа и владельцы файлов зависят от настроек пользователя внутри образа.

---

## Назначение репозитория

Репозиторий служит шаблоном рабочего окружения, который можно:

- Использовать как готовую dev‑среду для небольших или учебных C++ проектов.
- Форкнуть и доработать под собственный C++ проект, сохраняя Docker‑окружение и интеграцию с VS Code.
- Расширять дополнительными зависимостями, таргетами CMake, тестами и CI‑конфигурацией по мере развития проекта.

## Полезные команды

- Пересобрать образ разработчика: `./rebuild_container.sh` (при необходимости работы контейнера вне VS code) 
- Запустить рабочий контейнер: `run_container.sh`
- Пересобрать образ индексатора: `./rebuild_indexer.sh` (перед этим необходимо добавить ваш проект в `projects/CMakeLists.txt` используя `add_subdirectory(project_name/path_to_cmake)`)

