# Workspace in Docker with clangd and VS Code
Этот репозиторий предоставляет повторяемое рабочее окружение для C++ на любой машине с Docker: внутри контейнера преднастроены clangd, CMake и сопутствующие инструменты, а проект удобно открывать в VS Code с локальными настройками и расширениями. Идея — «клонировать, запустить контейнер и сразу работать» без настройки toolchain на хосте.

## Возможности

Готовый Docker-образ для разработки на C++ с предустановленными:

- clang/clangd для автодополнения, навигации и диагностики
- CMake/Make/Ninja для сборки
- clang-tidy и форматирование по .clang-format

## Поддержка VS Code:

- Папка .vscode с настройками и рекомендуемыми расширениями
- Работа прямо из VS Code (через Dev Containers/Remote – Containers или локально с подключением к контейнеру)

## Быстрый старт
### Требования:

- Установленный Docker (Desktop/Engine)
- VS Code (рекомендуется) и расширение Dev Containers, либо любая IDE/редактор, если комфортно работать «из терминала»

Шаги:
1. Клонировать репозиторий:
```
git clone https://github.com/romanvac/cpp-workspace
```

2. Собрать образ разработчика:
```
./dev_rebuild.sh
```
3. Запустить контейнер с монтированием репозитория:
```
./dev_run.sh
```
4. Сборка и генерация compile_commands.json:
Внутри контейнера (скрипт для сборки образа индексатора):
```
./rebuild_indexer.sh
```
Также в ```clangd_indexer/CMakeLists.txt``` добавить ваш проект, который должен находиться внутри ```/projects```

## Работа с примерами
В репозитории есть пример проекта: projects/fast_test/src.

## При добавлении новых подпроектов придерживаться общей схемы:

```projects/<name>/src``` — исходники
```projects/<name>/CMakeLists.txt``` — описание сборки

## Рекомендации:

- Держать ```compile_commands.json``` актуальным
- Избегать запуска ```clangd``` на хосте, если сборка выполняется внутри контейнера: пути в ```compile_commands.json``` абсолютные, и на хосте они не совпадают с путями в контейнере; поэтому clangd должен работать в том же файловом пространстве, что и сборка, то есть внутри контейнера

## Настройки качества кода
```.clang-format``` — форматирование (стиль единый на всех машинах)

```.clang-tidy``` — статический анализ (диагностики и автопочинки)

```.clangd``` — опции сервера (включая путь к compile_commands.json, дополнительные флаги и т.п.)

Можно править эти файлы под свой стиль и требования команды; изменения сразу подхватит clangd/VS Code.

## Полезные команды
Пересобрать образ разработчика:
```./dev_rebuild.sh```

Запустить рабочий контейнер:
```./dev_run.sh```

Пересобрать образ индексатора:
```./rebuild_indexer.sh```

